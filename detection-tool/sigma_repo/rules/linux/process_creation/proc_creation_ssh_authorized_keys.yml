title: SSH Authorized Keys Modification
id: 5e6f7a8b-9c0d-1e2f-3a4b-5c6d7e8f9a0b
status: stable
description: Detects modification of SSH authorized_keys file for backdoor access
references:
    - https://attack.mitre.org/techniques/T1098/004/
author: Sigma HQ
date: 2024/01/15
tags:
    - attack.persistence
    - attack.t1098.004
logsource:
    product: linux
    category: process_creation
detection:
    selection_command:
        Image|endswith:
            - '/echo'
            - '/tee'
            - '/cat'
    selection_file:
        CommandLine|contains: 'authorized_keys'
    selection_redirect:
        CommandLine|contains:
            - '>>'
            - '>'
    condition: selection_command and selection_file and selection_redirect
falsepositives:
    - System administration
    - SSH key deployment automation
level: high
